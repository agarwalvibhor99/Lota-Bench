/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: 'Could not load this library: /notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torchvision/image.so'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'config_alfred': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
{'planner': {'model_name': '/notebooks/LLMTaskPlanning/models/Qwen3-4B-Instruct-2507', 'use_accelerate_device_map': True, 'load_in_8bit': True, 'device': 'cuda', 'max_steps': 25, 'random_seed': 0, 'scoring_batch_size': 4, 'score_function': 'sum', 'scoring_mode': 'guidance', 'use_predefined_prompt': False, 'hf_auth_token': '', 'openai_api_key': ''}, 'name': 'alfred', 'out_dir': '${hydra:run.dir}', 'prompt': {'num_examples': 6, 'splitter': '', 'prefix': "Robot: Hi there, I'm a robot operating in a home.\nRobot: You can ask me to do various tasks and I'll tell you the sequence of actions I would do to accomplish your task.\n", 'example_file_path': 'resource/alfred_examples_for_prompt.json'}, 'alfred': {'x_display': '1', 'eval_set': 'valid_seen', 'eval_portion_in_percent': 5, 'random_seed_for_eval_subset': 1}}
[2025-12-03 02:59:30,429][src.alfred.alfred_evaluator][INFO] - planner:
  model_name: /notebooks/LLMTaskPlanning/models/Qwen3-4B-Instruct-2507
  use_accelerate_device_map: true
  load_in_8bit: true
  device: cuda
  max_steps: 25
  random_seed: 0
  scoring_batch_size: 4
  score_function: sum
  scoring_mode: guidance
  use_predefined_prompt: false
  hf_auth_token: ''
  openai_api_key: ''
name: alfred
out_dir: ${hydra:run.dir}
prompt:
  num_examples: 6
  splitter: ''
  prefix: 'Robot: Hi there, I''m a robot operating in a home.

    Robot: You can ask me to do various tasks and I''ll tell you the sequence of actions
    I would do to accomplish your task.

    '
  example_file_path: resource/alfred_examples_for_prompt.json
alfred:
  x_display: '1'
  eval_set: valid_seen
  eval_portion_in_percent: 5
  random_seed_for_eval_subset: 1

/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/models/auto/tokenization_auto.py:1041: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/models/auto/auto_factory.py:492: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers. Please use `token` instead.
  warnings.warn(
`torch_dtype` is deprecated! Use `dtype` instead!
The `load_in_4bit` and `load_in_8bit` arguments are deprecated and will be removed in the future versions. Please, pass a `BitsAndBytesConfig` object in `quantization_config` argument instead.
The following generation flags are not valid and may be ignored: ['temperature']. Set `TRANSFORMERS_VERBOSITY=info` for more details.
Loading LLM and tokenizer: /notebooks/LLMTaskPlanning/models/Qwen3-4B-Instruct-2507
[2025-12-03 02:59:35,986][accelerate.utils.modeling][INFO] - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|                                                                                                                       | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|█████████████████████████████████████                                                                          | 1/3 [00:09<00:19,  9.73s/it]Loading checkpoint shards:  67%|██████████████████████████████████████████████████████████████████████████                                     | 2/3 [00:19<00:09,  9.87s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:20<00:00,  5.51s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:20<00:00,  6.67s/it]
[2025-12-03 02:59:58,041][src.alfred.alfred_task_planner][INFO] - # of skills: 214
[2025-12-03 02:59:58,042][src.alfred.alfred_task_planner][INFO] - [' done', ' find a cart', ' find an arm chair', ' find a watch', ' find a pepper shaker', ' find a cup', ' find a pencil', ' find a kettle', ' find a cell phone', ' find a desk', ' find a baseball bat', ' find a safe', ' find a stove burner', ' find a wine bottle', ' find a mug', ' find a sofa', ' find a soap bar', ' find a cabinet', ' find a dish sponge', ' find a plate', ' find a pillow', ' find a coffee machine', ' find a candle', ' find a ladle', ' find a tissue box', ' find a spray bottle', ' find a pan', ' find a desk lamp', ' find a newspaper', ' find a tennis racket', ' find a garbage can', ' find a glassbottle', ' find a fork', ' find a CD', ' find a laptop', ' find a bread', ' find a coffee table', ' find a credit card', ' find a basket ball', ' find a potato', ' find a hand towel', ' find a bathtub', ' find a knife', ' find a salt shaker', ' find a spoon', ' find a pen', ' find a key chain', ' find a fridge', ' find a bowl', ' find a box', ' find a statue', ' find a bed', ' find a plunger', ' find a watering can', ' find a counter top', ' find a side table', ' find a toilet paper', ' find an egg', ' find a tomato', ' find a butter knife', ' find a cloth', ' find an ottoman', ' find a sink', ' find an apple', ' find a shelf', ' find a dresser', ' find a remote control', ' find a drawer', ' find a toilet paper hanger', ' find a pot', ' find an alarm clock', ' find a vase', ' find a faucet', ' find a toilet', ' find a lettuce', ' find a spatula', ' find a microwave', ' find a book', ' find a soap bottle', ' find a dining table', ' find a floor lamp', ' pick up the key chain', ' put down the key chain', ' pick up the potato', ' put down the potato', ' pick up the pot', ' put down the pot', ' pick up the pen', ' put down the pen', ' pick up the candle', ' put down the candle', ' pick up the CD', ' put down the CD', ' pick up the pan', ' put down the pan', ' pick up the watch', ' put down the watch', ' pick up the newspaper', ' put down the newspaper', ' pick up the hand towel', ' put down the hand towel', ' pick up the spray bottle', ' put down the spray bottle', ' pick up the baseball bat', ' put down the baseball bat', ' pick up the bread', ' put down the bread', ' pick up the cell phone', ' put down the cell phone', ' pick up the book', ' put down the book', ' pick up the lettuce', ' put down the lettuce', ' pick up the credit card', ' put down the credit card', ' pick up the mug', ' put down the mug', ' pick up the alarm clock', ' put down the alarm clock', ' pick up the kettle', ' put down the kettle', ' pick up the toilet paper', ' put down the toilet paper', ' pick up the bowl', ' put down the bowl', ' pick up the fork', ' put down the fork', ' pick up the box', ' put down the box', ' pick up the egg', ' put down the egg', ' pick up the spoon', ' put down the spoon', ' pick up the tissue box', ' put down the tissue box', ' pick up the apple', ' put down the apple', ' pick up the tennis racket', ' put down the tennis racket', ' pick up the ladle', ' put down the ladle', ' pick up the wine bottle', ' put down the wine bottle', ' pick up the cloth', ' put down the cloth', ' pick up the plunger', ' put down the plunger', ' pick up the soap bar', ' put down the soap bar', ' pick up the pencil', ' put down the pencil', ' pick up the laptop', ' put down the laptop', ' pick up the remote control', ' put down the remote control', ' pick up the basket ball', ' put down the basket ball', ' pick up the dish sponge', ' put down the dish sponge', ' pick up the cup', ' put down the cup', ' pick up the spatula', ' put down the spatula', ' pick up the salt shaker', ' put down the salt shaker', ' pick up the plate', ' put down the plate', ' pick up the pepper shaker', ' put down the pepper shaker', ' pick up the pillow', ' put down the pillow', ' pick up the glassbottle', ' put down the glassbottle', ' pick up the soap bottle', ' put down the soap bottle', ' pick up the knife', ' put down the knife', ' pick up the statue', ' put down the statue', ' pick up the tomato', ' put down the tomato', ' pick up the butter knife', ' put down the butter knife', ' pick up the watering can', ' put down the watering can', ' pick up the vase', ' put down the vase', ' open the safe', ' close the safe', ' open the laptop', ' close the laptop', ' open the fridge', ' close the fridge', ' open the box', ' close the box', ' open the microwave', ' close the microwave', ' open the cabinet', ' close the cabinet', ' open the drawer', ' close the drawer', ' slice the potato', ' slice the lettuce', ' slice the tomato', ' slice the apple', ' slice the bread', ' turn on the microwave', ' turn off the microwave', ' turn on the desk lamp', ' turn off the desk lamp', ' turn on the floor lamp', ' turn off the floor lamp', ' turn on the faucet', ' turn off the faucet']
thor-201909061227-Linux64: [                                                                                                                         0%   0.0 s/B]  of 390.MB
thor-201909061227-Linux64: [                                                                                                                       0% 225.6 KiB/s]  of 390.MB
thor-201909061227-Linux64: [                                                                                                                       0% 576.1 KiB/s]  of 390.MB
thor-201909061227-Linux64: [                                                                                                                       0%   1.6 MiB/s]  of 390.MB
thor-201909061227-Linux64: [                                                                                                                       0%   3.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|                                                                                                                      1%   6.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||                                                                                                                     1%   8.6 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||                                                                                                                     2%  10.3 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||                                                                                                                    2%  11.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||                                                                                                                   3%  13.0 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||                                                                                                                  4%  15.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||                                                                                                                 5%  16.5 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||                                                                                                                 5%  17.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||                                                                                                                6%  17.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||                                                                                                               6%  18.3 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||                                                                                                              8%  19.9 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||                                                                                                             8%  20.3 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||                                                                                                             9%  20.6 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||                                                                                                            9%  20.9 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||                                                                                                          10%  21.2 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||                                                                                                         11%  22.3 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||                                                                                                        12%  22.5 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||                                                                                                        12%  22.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||                                                                                                       13%  22.9 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||                                                                                                      14%  23.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||                                                                                                     15%  23.9 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||                                                                                                    15%  24.0 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||                                                                                                    16%  24.2 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||                                                                                                   17%  24.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||                                                                                                  17%  25.0 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||                                                                                                 18%  25.0 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||                                                                                                19%  25.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||                                                                                               20%  25.5 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||                                                                                              20%  25.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||                                                                                              21%  25.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||                                                                                             22%  26.2 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||                                                                                            23%  26.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||                                                                                           23%  26.5 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||                                                                                          24%  26.5 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||                                                                                         25%  26.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||                                                                                        26%  26.9 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||                                                                                        26%  27.0 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||                                                                                       27%  27.0 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||                                                                                      28%  27.3 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||                                                                                     28%  27.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||                                                                                    29%  27.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||                                                                                    30%  27.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||                                                                                  31%  27.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||                                                                                  31%  27.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||                                                                                 32%  27.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||                                                                                32%  27.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||                                                                               33%  28.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||                                                                              34%  28.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||                                                                              35%  28.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||                                                                            36%  28.3 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||                                                                            36%  28.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||                                                                           37%  28.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||                                                                          38%  28.5 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||                                                                         38%  28.5 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||                                                                        39%  28.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||                                                                        40%  28.6 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||                                                                       41%  28.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||                                                                      41%  28.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||                                                                     42%  28.9 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||                                                                    43%  28.9 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||                                                                   44%  29.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||                                                                  45%  29.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||                                                                  45%  29.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||                                                                 46%  29.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                                46%  29.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                               47%  29.2 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                              48%  29.2 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                              49%  29.3 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                             49%  29.2 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                            50%  29.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                           51%  29.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                          52%  29.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                         52%  29.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                        53%  29.6 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                       54%  29.6 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                       54%  29.6 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                      55%  29.6 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                     56%  29.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                    57%  29.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                   57%  29.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                  58%  29.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                 59%  29.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                 60%  29.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                                60%  29.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                               61%  30.0 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                              62%  30.0 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                             63%  30.0 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                            63%  30.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                           64%  30.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                           65%  30.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                          65%  30.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                         66%  30.1 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                        67%  30.2 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                       68%  30.2 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                       68%  30.2 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                      69%  30.3 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                     70%  30.3 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                    71%  30.3 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                   71%  30.3 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                  72%  30.3 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                 73%  30.3 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                 73%  30.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                74%  30.3 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                               75%  30.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                              76%  30.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                             76%  30.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                             77%  30.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                            78%  30.5 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                           79%  30.5 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                          79%  30.5 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                         80%  30.5 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                         80%  30.4 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                       82%  30.5 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                       82%  30.6 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                      83%  30.5 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                     84%  30.6 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                    84%  30.6 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                   85%  30.6 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                  86%  30.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                 87%  30.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                 87%  30.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||                88%  30.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||               89%  30.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||              90%  30.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||             90%  30.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||             91%  30.7 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||            92%  30.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||           93%  30.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||          93%  30.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||         94%  30.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||        95%  30.9 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||       95%  30.9 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||       96%  30.8 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||     97%  30.9 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||     98%  30.9 MiB/s]  of 390.MB
thor-201909061227-Linux64: [||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||    98%  30.9 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||   99%  30.9 MiB/s]  of 390.MB
thor-201909061227-Linux64: [|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| 100%  31.0 MiB/s]  of 390.MB
Found path: /root/.ai2thor/releases/thor-201909061227-Linux64/thor-201909061227-Linux64
Mono path[0] = '/root/.ai2thor/releases/thor-201909061227-Linux64/thor-201909061227-Linux64_Data/Managed'
Mono config path = '/root/.ai2thor/releases/thor-201909061227-Linux64/thor-201909061227-Linux64_Data/Mono/etc'
Unable to preload the following plugins:
	ScreenSelector.so
Display 0 'screen': 1024x768 (primary device).
PlayerPrefs - Creating folder: /root/.config/unity3d/Allen Institute for Artificial Intelligence
PlayerPrefs - Creating folder: /root/.config/unity3d/Allen Institute for Artificial Intelligence/AI2-Thor
Logging to /root/.config/unity3d/Allen Institute for Artificial Intelligence/AI2-Thor/Player.log
ALSA lib confmisc.c:855:(parse_card) cannot find card '0'
ALSA lib conf.c:5178:(_snd_config_evaluate) function snd_func_card_inum returned error: No such file or directory
ALSA lib confmisc.c:422:(snd_func_concat) error evaluating strings
ALSA lib conf.c:5178:(_snd_config_evaluate) function snd_func_concat returned error: No such file or directory
ALSA lib confmisc.c:1334:(snd_func_refer) error evaluating name
ALSA lib conf.c:5178:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5701:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2664:(snd_pcm_open_noupdate) Unknown PCM default
ALSA lib confmisc.c:855:(parse_card) cannot find card '0'
ALSA lib conf.c:5178:(_snd_config_evaluate) function snd_func_card_inum returned error: No such file or directory
ALSA lib confmisc.c:422:(snd_func_concat) error evaluating strings
ALSA lib conf.c:5178:(_snd_config_evaluate) function snd_func_concat returned error: No such file or directory
ALSA lib confmisc.c:1334:(snd_func_refer) error evaluating name
ALSA lib conf.c:5178:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5701:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2664:(snd_pcm_open_noupdate) Unknown PCM default
{'tests_seen': 1533,
 'tests_unseen': 1529,
 'train': 21023,
 'valid_seen': 820,
 'valid_unseen': 821}
ThorEnv started.
  0%|                                                                                                                                                 | 0/34 [00:00<?, ?it/s][2025-12-03 03:00:26,324][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 0, 'task': 'pick_and_place_simple-SoapBar-None-Cart-401/trial_T20190907_054906_608944'}
[2025-12-03 03:00:26,380][src.alfred.alfred_evaluator][INFO] - Evaluating (1/34): alfred/data/json_2.1.0/pick_and_place_simple-SoapBar-None-Cart-401/trial_T20190907_054906_608944
Resetting ThorEnv
[2025-12-03 03:00:45,084][src.alfred.alfred_evaluator][INFO] - Task: To place the soap on the rack.
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:00:45,939][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
  3%|████                                                                                                                                     | 1/34 [00:19<10:47, 19.61s/it][2025-12-03 03:00:45,939][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 5, 'task': 'pick_cool_then_place_in_recep-Plate-None-Cabinet-27/trial_T20190906_173120_350651'}
[2025-12-03 03:00:45,955][src.alfred.alfred_evaluator][INFO] - Evaluating (2/34): alfred/data/json_2.1.0/pick_cool_then_place_in_recep-Plate-None-Cabinet-27/trial_T20190906_173120_350651
Resetting ThorEnv
[2025-12-03 03:01:03,189][src.alfred.alfred_evaluator][INFO] - Task: Put a plate in a cabinet.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:01:03,448][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
  6%|████████                                                                                                                                 | 2/34 [00:37<09:48, 18.38s/it][2025-12-03 03:01:03,448][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 0, 'task': 'pick_and_place_simple-Book-None-Sofa-229/trial_T20190907_042856_259139'}
[2025-12-03 03:01:03,455][src.alfred.alfred_evaluator][INFO] - Evaluating (3/34): alfred/data/json_2.1.0/pick_and_place_simple-Book-None-Sofa-229/trial_T20190907_042856_259139
Resetting ThorEnv
[2025-12-03 03:01:13,477][src.alfred.alfred_evaluator][INFO] - Task: Move a book from a desk to a sofa.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:01:13,751][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
  9%|████████████                                                                                                                             | 3/34 [00:47<07:35, 14.69s/it][2025-12-03 03:01:13,751][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 2, 'task': 'pick_clean_then_place_in_recep-DishSponge-None-Cart-401/trial_T20190907_024634_972453'}
[2025-12-03 03:01:13,761][src.alfred.alfred_evaluator][INFO] - Evaluating (4/34): alfred/data/json_2.1.0/pick_clean_then_place_in_recep-DishSponge-None-Cart-401/trial_T20190907_024634_972453
Resetting ThorEnv
[2025-12-03 03:01:17,053][src.alfred.alfred_evaluator][INFO] - Task: Put a clean sponge on a metal rack.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:01:17,309][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 12%|████████████████                                                                                                                         | 4/34 [00:50<05:08, 10.29s/it][2025-12-03 03:01:17,309][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 1, 'task': 'pick_cool_then_place_in_recep-BreadSliced-None-DiningTable-27/trial_T20190908_075813_148407'}
[2025-12-03 03:01:17,327][src.alfred.alfred_evaluator][INFO] - Evaluating (5/34): alfred/data/json_2.1.0/pick_cool_then_place_in_recep-BreadSliced-None-DiningTable-27/trial_T20190908_075813_148407
Resetting ThorEnv
[2025-12-03 03:01:18,959][src.alfred.alfred_evaluator][INFO] - Task: Slice bread and chill it in the fridge. 
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:01:19,192][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 15%|████████████████████▏                                                                                                                    | 5/34 [00:52<03:30,  7.26s/it][2025-12-03 03:01:19,192][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 0, 'task': 'pick_and_place_simple-ToiletPaper-None-ToiletPaperHanger-415/trial_T20190908_050518_595510'}
[2025-12-03 03:01:19,201][src.alfred.alfred_evaluator][INFO] - Evaluating (6/34): alfred/data/json_2.1.0/pick_and_place_simple-ToiletPaper-None-ToiletPaperHanger-415/trial_T20190908_050518_595510
Resetting ThorEnv
[2025-12-03 03:01:22,650][src.alfred.alfred_evaluator][INFO] - Task: Put a roll of toilet paper on the toilet paper holder.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:01:22,944][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 18%|████████████████████████▏                                                                                                                | 6/34 [00:56<02:49,  6.07s/it][2025-12-03 03:01:22,945][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 1, 'task': 'pick_clean_then_place_in_recep-ButterKnife-None-DiningTable-16/trial_T20190909_114508_617301'}
[2025-12-03 03:01:22,955][src.alfred.alfred_evaluator][INFO] - Evaluating (7/34): alfred/data/json_2.1.0/pick_clean_then_place_in_recep-ButterKnife-None-DiningTable-16/trial_T20190909_114508_617301
Resetting ThorEnv
[2025-12-03 03:01:27,510][src.alfred.alfred_evaluator][INFO] - Task: Put a clean butter knife on a round white table.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:01:27,769][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 21%|████████████████████████████▏                                                                                                            | 7/34 [01:01<02:32,  5.66s/it][2025-12-03 03:01:27,769][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 0, 'task': 'pick_and_place_simple-HandTowel-None-BathtubBasin-419/trial_T20190908_023400_293044'}
[2025-12-03 03:01:27,775][src.alfred.alfred_evaluator][INFO] - Evaluating (8/34): alfred/data/json_2.1.0/pick_and_place_simple-HandTowel-None-BathtubBasin-419/trial_T20190908_023400_293044
Resetting ThorEnv
[2025-12-03 03:01:33,369][src.alfred.alfred_evaluator][INFO] - Task: Place a towel in the bath tub.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:01:33,604][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 24%|████████████████████████████████▏                                                                                                        | 8/34 [01:07<02:28,  5.72s/it][2025-12-03 03:01:33,605][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 2, 'task': 'pick_and_place_simple-Newspaper-None-Sofa-224/trial_T20190909_111324_949106'}
[2025-12-03 03:01:33,612][src.alfred.alfred_evaluator][INFO] - Evaluating (9/34): alfred/data/json_2.1.0/pick_and_place_simple-Newspaper-None-Sofa-224/trial_T20190909_111324_949106
Resetting ThorEnv
[2025-12-03 03:01:38,971][src.alfred.alfred_evaluator][INFO] - Task: Move a newspaper from a dresser to a black couch.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:01:39,216][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 26%|████████████████████████████████████▎                                                                                                    | 9/34 [01:12<02:22,  5.68s/it][2025-12-03 03:01:39,216][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 0, 'task': 'pick_and_place_simple-Candle-None-Toilet-429/trial_T20190908_052232_887934'}
[2025-12-03 03:01:39,223][src.alfred.alfred_evaluator][INFO] - Evaluating (10/34): alfred/data/json_2.1.0/pick_and_place_simple-Candle-None-Toilet-429/trial_T20190908_052232_887934
Resetting ThorEnv
[2025-12-03 03:01:42,087][src.alfred.alfred_evaluator][INFO] - Task: Put a bottle on the back of a newspaper.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:01:42,360][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 29%|████████████████████████████████████████                                                                                                | 10/34 [01:16<01:57,  4.90s/it][2025-12-03 03:01:42,360][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 0, 'task': 'pick_cool_then_place_in_recep-PotatoSliced-None-SinkBasin-13/trial_T20190907_073447_193556'}
[2025-12-03 03:01:42,421][src.alfred.alfred_evaluator][INFO] - Evaluating (11/34): alfred/data/json_2.1.0/pick_cool_then_place_in_recep-PotatoSliced-None-SinkBasin-13/trial_T20190907_073447_193556
Resetting ThorEnv
[2025-12-03 03:01:46,225][src.alfred.alfred_evaluator][INFO] - Task: Place a cold potato slice in the sink.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:01:46,469][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 32%|████████████████████████████████████████████                                                                                            | 11/34 [01:20<01:47,  4.66s/it][2025-12-03 03:01:46,469][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 1, 'task': 'pick_clean_then_place_in_recep-Tomato-None-CounterTop-25/trial_T20190909_012550_586494'}
[2025-12-03 03:01:46,480][src.alfred.alfred_evaluator][INFO] - Evaluating (12/34): alfred/data/json_2.1.0/pick_clean_then_place_in_recep-Tomato-None-CounterTop-25/trial_T20190909_012550_586494
Resetting ThorEnv
[2025-12-03 03:01:50,659][src.alfred.alfred_evaluator][INFO] - Task: Put a cold, clean tomato on the counter.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:01:50,899][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 35%|████████████████████████████████████████████████                                                                                        | 12/34 [01:24<01:40,  4.59s/it][2025-12-03 03:01:50,900][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 1, 'task': 'pick_and_place_with_movable_recep-Watch-Bowl-Shelf-326/trial_T20190909_031836_927615'}
[2025-12-03 03:01:50,919][src.alfred.alfred_evaluator][INFO] - Evaluating (13/34): alfred/data/json_2.1.0/pick_and_place_with_movable_recep-Watch-Bowl-Shelf-326/trial_T20190909_031836_927615
Resetting ThorEnv
[2025-12-03 03:01:54,584][src.alfred.alfred_evaluator][INFO] - Task: Put a bowl with the watch in it on the shelf.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:01:54,812][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 38%|████████████████████████████████████████████████████                                                                                    | 13/34 [01:28<01:32,  4.38s/it][2025-12-03 03:01:54,813][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 1, 'task': 'pick_and_place_simple-CreditCard-None-Drawer-227/trial_T20190909_010644_297017'}
[2025-12-03 03:01:54,824][src.alfred.alfred_evaluator][INFO] - Evaluating (14/34): alfred/data/json_2.1.0/pick_and_place_simple-CreditCard-None-Drawer-227/trial_T20190909_010644_297017
Resetting ThorEnv
[2025-12-03 03:01:58,278][src.alfred.alfred_evaluator][INFO] - Task: Place a credit card into a drawer
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:01:58,526][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 41%|████████████████████████████████████████████████████████                                                                                | 14/34 [01:32<01:23,  4.18s/it][2025-12-03 03:01:58,526][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 2, 'task': 'pick_clean_then_place_in_recep-Cloth-None-Toilet-413/trial_T20190908_175253_104175'}
[2025-12-03 03:01:58,534][src.alfred.alfred_evaluator][INFO] - Evaluating (15/34): alfred/data/json_2.1.0/pick_clean_then_place_in_recep-Cloth-None-Toilet-413/trial_T20190908_175253_104175
Resetting ThorEnv
[2025-12-03 03:02:02,066][src.alfred.alfred_evaluator][INFO] - Task: Put a clean rag on the toilet. 
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:02:02,315][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 44%|████████████████████████████████████████████████████████████                                                                            | 15/34 [01:35<01:17,  4.06s/it][2025-12-03 03:02:02,315][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 1, 'task': 'pick_heat_then_place_in_recep-Mug-None-SideTable-21/trial_T20190909_090729_088825'}
[2025-12-03 03:02:02,342][src.alfred.alfred_evaluator][INFO] - Evaluating (16/34): alfred/data/json_2.1.0/pick_heat_then_place_in_recep-Mug-None-SideTable-21/trial_T20190909_090729_088825
Resetting ThorEnv
[2025-12-03 03:02:06,281][src.alfred.alfred_evaluator][INFO] - Task: Put a heated mug on the small black table, left of the tomato. 
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:02:06,526][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 47%|████████████████████████████████████████████████████████████████                                                                        | 16/34 [01:40<01:13,  4.11s/it][2025-12-03 03:02:06,526][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 1, 'task': 'pick_and_place_with_movable_recep-TissueBox-Plate-DiningTable-203/trial_T20190909_141915_002879'}
[2025-12-03 03:02:06,534][src.alfred.alfred_evaluator][INFO] - Evaluating (17/34): alfred/data/json_2.1.0/pick_and_place_with_movable_recep-TissueBox-Plate-DiningTable-203/trial_T20190909_141915_002879
Resetting ThorEnv
[2025-12-03 03:02:21,826][src.alfred.alfred_evaluator][INFO] - Task: take a dish to the table to put tissue box on it
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:02:22,080][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 50%|████████████████████████████████████████████████████████████████████                                                                    | 17/34 [01:55<02:08,  7.55s/it][2025-12-03 03:02:22,080][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 2, 'task': 'pick_heat_then_place_in_recep-PotatoSliced-None-SinkBasin-13/trial_T20190909_115736_122556'}
[2025-12-03 03:02:22,100][src.alfred.alfred_evaluator][INFO] - Evaluating (18/34): alfred/data/json_2.1.0/pick_heat_then_place_in_recep-PotatoSliced-None-SinkBasin-13/trial_T20190909_115736_122556
Resetting ThorEnv
[2025-12-03 03:02:25,245][src.alfred.alfred_evaluator][INFO] - Task: Put a sliced egg inside the sink
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:02:25,478][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 53%|████████████████████████████████████████████████████████████████████████                                                                | 18/34 [01:59<01:40,  6.30s/it][2025-12-03 03:02:25,479][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 2, 'task': 'pick_and_place_with_movable_recep-TomatoSliced-Bowl-Fridge-20/trial_T20190907_060455_935544'}
[2025-12-03 03:02:25,494][src.alfred.alfred_evaluator][INFO] - Evaluating (19/34): alfred/data/json_2.1.0/pick_and_place_with_movable_recep-TomatoSliced-Bowl-Fridge-20/trial_T20190907_060455_935544
Resetting ThorEnv
[2025-12-03 03:02:31,060][src.alfred.alfred_evaluator][INFO] - Task: Refrigerate a tomato slice in a bowl
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:02:31,360][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 56%|████████████████████████████████████████████████████████████████████████████                                                            | 19/34 [02:05<01:32,  6.18s/it][2025-12-03 03:02:31,361][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 1, 'task': 'pick_and_place_with_movable_recep-AppleSliced-Plate-Fridge-13/trial_T20190919_001342_371546'}
[2025-12-03 03:02:31,395][src.alfred.alfred_evaluator][INFO] - Evaluating (20/34): alfred/data/json_2.1.0/pick_and_place_with_movable_recep-AppleSliced-Plate-Fridge-13/trial_T20190919_001342_371546
Resetting ThorEnv
[2025-12-03 03:02:34,210][src.alfred.alfred_evaluator][INFO] - Task: Put a slice of apple on a plate in the fridge.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:02:34,450][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 59%|████████████████████████████████████████████████████████████████████████████████                                                        | 20/34 [02:08<01:13,  5.25s/it][2025-12-03 03:02:34,451][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 2, 'task': 'pick_and_place_with_movable_recep-Spatula-Pan-CounterTop-17/trial_T20190906_194903_710920'}
[2025-12-03 03:02:34,459][src.alfred.alfred_evaluator][INFO] - Evaluating (21/34): alfred/data/json_2.1.0/pick_and_place_with_movable_recep-Spatula-Pan-CounterTop-17/trial_T20190906_194903_710920
Resetting ThorEnv
[2025-12-03 03:02:37,193][src.alfred.alfred_evaluator][INFO] - Task: Plan a pan with a spatula in it down on the counter to the right of the toaster.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:02:37,566][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 62%|████████████████████████████████████████████████████████████████████████████████████                                                    | 21/34 [02:11<00:59,  4.61s/it][2025-12-03 03:02:37,566][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 2, 'task': 'pick_clean_then_place_in_recep-Fork-None-Drawer-8/trial_T20190908_132152_999725'}
[2025-12-03 03:02:37,575][src.alfred.alfred_evaluator][INFO] - Evaluating (22/34): alfred/data/json_2.1.0/pick_clean_then_place_in_recep-Fork-None-Drawer-8/trial_T20190908_132152_999725
Resetting ThorEnv
[2025-12-03 03:02:41,684][src.alfred.alfred_evaluator][INFO] - Task: Wash the fork.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:02:41,919][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 65%|████████████████████████████████████████████████████████████████████████████████████████                                                | 22/34 [02:15<00:54,  4.53s/it][2025-12-03 03:02:41,919][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 0, 'task': 'pick_heat_then_place_in_recep-Tomato-None-Fridge-24/trial_T20190908_033721_967359'}
[2025-12-03 03:02:41,930][src.alfred.alfred_evaluator][INFO] - Evaluating (23/34): alfred/data/json_2.1.0/pick_heat_then_place_in_recep-Tomato-None-Fridge-24/trial_T20190908_033721_967359
Resetting ThorEnv
[2025-12-03 03:02:44,088][src.alfred.alfred_evaluator][INFO] - Task: Put a cooked tomato into the refrigerator.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:02:44,340][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 68%|████████████████████████████████████████████████████████████████████████████████████████████                                            | 23/34 [02:18<00:42,  3.90s/it][2025-12-03 03:02:44,340][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 2, 'task': 'pick_and_place_simple-Cloth-None-BathtubBasin-405/trial_T20190906_162502_940304'}
[2025-12-03 03:02:44,351][src.alfred.alfred_evaluator][INFO] - Evaluating (24/34): alfred/data/json_2.1.0/pick_and_place_simple-Cloth-None-BathtubBasin-405/trial_T20190906_162502_940304
Resetting ThorEnv
[2025-12-03 03:02:46,042][src.alfred.alfred_evaluator][INFO] - Task: place a rag inside the tub
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:02:46,290][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 71%|████████████████████████████████████████████████████████████████████████████████████████████████                                        | 24/34 [02:19<00:33,  3.31s/it][2025-12-03 03:02:46,291][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 0, 'task': 'pick_and_place_with_movable_recep-TomatoSliced-Pan-Fridge-11/trial_T20190909_011522_113515'}
[2025-12-03 03:02:46,311][src.alfred.alfred_evaluator][INFO] - Evaluating (25/34): alfred/data/json_2.1.0/pick_and_place_with_movable_recep-TomatoSliced-Pan-Fridge-11/trial_T20190909_011522_113515
Resetting ThorEnv
[2025-12-03 03:02:53,640][src.alfred.alfred_evaluator][INFO] - Task: To place a pan with a tomato slice in it in the fridge.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:02:53,882][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 74%|████████████████████████████████████████████████████████████████████████████████████████████████████                                    | 25/34 [02:27<00:41,  4.60s/it][2025-12-03 03:02:53,882][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 1, 'task': 'pick_clean_then_place_in_recep-Ladle-None-DiningTable-27/trial_T20190911_131350_027076'}
[2025-12-03 03:02:53,896][src.alfred.alfred_evaluator][INFO] - Evaluating (26/34): alfred/data/json_2.1.0/pick_clean_then_place_in_recep-Ladle-None-DiningTable-27/trial_T20190911_131350_027076
Resetting ThorEnv
[2025-12-03 03:02:55,627][src.alfred.alfred_evaluator][INFO] - Task: Place a clean ladle on a table.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:02:55,862][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 76%|████████████████████████████████████████████████████████████████████████████████████████████████████████                                | 26/34 [02:29<00:30,  3.81s/it][2025-12-03 03:02:55,863][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 2, 'task': 'pick_clean_then_place_in_recep-AppleSliced-None-DiningTable-27/trial_T20190907_151802_277016'}
[2025-12-03 03:02:55,883][src.alfred.alfred_evaluator][INFO] - Evaluating (27/34): alfred/data/json_2.1.0/pick_clean_then_place_in_recep-AppleSliced-None-DiningTable-27/trial_T20190907_151802_277016
Resetting ThorEnv
[2025-12-03 03:02:57,996][src.alfred.alfred_evaluator][INFO] - Task: Cut an apple with a knife, wash the apple slice, place the apple slice on the table
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:02:58,255][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████                            | 27/34 [02:31<00:23,  3.39s/it][2025-12-03 03:02:58,255][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 0, 'task': 'pick_and_place_simple-Newspaper-None-Sofa-224/trial_T20190909_111324_949106'}
[2025-12-03 03:02:58,263][src.alfred.alfred_evaluator][INFO] - Evaluating (28/34): alfred/data/json_2.1.0/pick_and_place_simple-Newspaper-None-Sofa-224/trial_T20190909_111324_949106
Resetting ThorEnv
[2025-12-03 03:03:00,744][src.alfred.alfred_evaluator][INFO] - Task: Place a newspaper on a couch.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:03:00,981][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████                        | 28/34 [02:34<00:19,  3.19s/it][2025-12-03 03:03:00,981][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 1, 'task': 'pick_heat_then_place_in_recep-Mug-None-CoffeeMachine-1/trial_T20190907_222640_487432'}
[2025-12-03 03:03:01,003][src.alfred.alfred_evaluator][INFO] - Evaluating (29/34): alfred/data/json_2.1.0/pick_heat_then_place_in_recep-Mug-None-CoffeeMachine-1/trial_T20190907_222640_487432
Resetting ThorEnv
[2025-12-03 03:03:04,734][src.alfred.alfred_evaluator][INFO] - Task: Warm up the cup on the coffee maker.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:03:04,993][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 85%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                    | 29/34 [02:38<00:17,  3.44s/it][2025-12-03 03:03:04,993][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 0, 'task': 'pick_clean_then_place_in_recep-ButterKnife-None-Drawer-30/trial_T20190908_052007_212776'}
[2025-12-03 03:03:05,004][src.alfred.alfred_evaluator][INFO] - Evaluating (30/34): alfred/data/json_2.1.0/pick_clean_then_place_in_recep-ButterKnife-None-Drawer-30/trial_T20190908_052007_212776
Resetting ThorEnv
[2025-12-03 03:03:37,549][src.alfred.alfred_evaluator][INFO] - Task: Place a rinsed knife inside a drawer.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:03:37,824][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                | 30/34 [03:11<00:49, 12.25s/it][2025-12-03 03:03:37,824][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 2, 'task': 'pick_and_place_simple-Candle-None-Toilet-429/trial_T20190908_052232_887934'}
[2025-12-03 03:03:37,830][src.alfred.alfred_evaluator][INFO] - Evaluating (31/34): alfred/data/json_2.1.0/pick_and_place_simple-Candle-None-Toilet-429/trial_T20190908_052232_887934
Resetting ThorEnv
[2025-12-03 03:03:40,447][src.alfred.alfred_evaluator][INFO] - Task: Place a candle on top of the toilet.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:03:40,718][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████            | 31/34 [03:14<00:28,  9.45s/it][2025-12-03 03:03:40,718][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 1, 'task': 'pick_and_place_with_movable_recep-DishSponge-Pot-SinkBasin-1/trial_T20190908_103955_680867'}
[2025-12-03 03:03:40,729][src.alfred.alfred_evaluator][INFO] - Evaluating (32/34): alfred/data/json_2.1.0/pick_and_place_with_movable_recep-DishSponge-Pot-SinkBasin-1/trial_T20190908_103955_680867
Resetting ThorEnv
[2025-12-03 03:03:43,106][src.alfred.alfred_evaluator][INFO] - Task: Move the pot with the green sponge from the refrigerator to the sink.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:03:43,355][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 32/34 [03:17<00:14,  7.40s/it][2025-12-03 03:03:43,355][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 2, 'task': 'pick_cool_then_place_in_recep-Cup-None-SideTable-21/trial_T20190906_192823_237997'}
[2025-12-03 03:03:43,369][src.alfred.alfred_evaluator][INFO] - Evaluating (33/34): alfred/data/json_2.1.0/pick_cool_then_place_in_recep-Cup-None-SideTable-21/trial_T20190906_192823_237997
Resetting ThorEnv
[2025-12-03 03:03:48,939][src.alfred.alfred_evaluator][INFO] - Task: Put a chilled vase on the three tiered black table.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:03:49,184][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
 97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████    | 33/34 [03:22<00:06,  6.93s/it][2025-12-03 03:03:49,184][src.alfred.alfred_evaluator][INFO] - {'repeat_idx': 2, 'task': 'pick_clean_then_place_in_recep-Cloth-None-Drawer-423/trial_T20190908_140701_251653'}
[2025-12-03 03:03:49,191][src.alfred.alfred_evaluator][INFO] - Evaluating (34/34): alfred/data/json_2.1.0/pick_clean_then_place_in_recep-Cloth-None-Drawer-423/trial_T20190908_140701_251653
Resetting ThorEnv
[2025-12-03 03:04:16,480][src.alfred.alfred_evaluator][INFO] - Task: Put a clean cloth in a drawer.
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 135, in evaluate_main
    result = self.evaluate_task(env, traj_data, r_idx, model_args, planner, save_path, log_prompt=(i==0), train_gt_steps=train_gt_steps)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 190, in evaluate_task
    step, prompt = planner.plan_step_by_step(instruction_text, prev_steps, prev_action_msg)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 212, in plan_step_by_step
    scores = self.score(prompt, self.skill_set)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/src/task_planner.py", line 89, in score
    scores = out['score']
             ~~~^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program.py", line 470, in __getitem__
    return self._variables[key]
           ~~~~~~~~~~~~~~~^^^^^
KeyError: 'score'
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 109, in run
    await self.visit(self.parse_tree, VariableStack([self.program._variables], self))
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 559, in visit
    visited_children.append(await self.visit(child, variable_stack, inner_next_node, inner_next_next_node, inner_prev_node, node, parent_node))
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in visit
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 266, in <listcomp>
    visited_children = [await self.visit(child, variable_stack, next_node, next_next_node, prev_node, node, parent_node) for child in node]
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/_program_executor.py", line 379, in visit
    command_output = await command_function(*positional_args, **named_args)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 151, in select
    option_logprobs = await recursive_select([])
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/library/_select.py", line 107, in recursive_select
    gen_obj = await parser.llm_session(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/guidance/llms/_transformers.py", line 335, in __call__
    generated_sequence = self.llm.model_obj.generate(**generate_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 2543, in generate
    prepared_logits_processor = self._get_logits_processor(
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/utils.py", line 1267, in _get_logits_processor
    processors.append(TemperatureLogitsWarper(generation_config.temperature))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/notebooks/LLMTaskPlanning/lota-bench-venv/lib/python3.11/site-packages/transformers/generation/logits_process.py", line 287, in __init__
    raise ValueError(except_msg)
ValueError: `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.

Error in program:  `temperature` (=0.0) has to be a strictly positive float, otherwise your next token scores will be invalid. If you're looking for greedy decoding strategies, set `do_sample=False`.
[2025-12-03 03:04:16,745][src.alfred.alfred_evaluator][INFO] - Error: KeyError('score')
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [03:50<00:00, 13.12s/it]100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 34/34 [03:50<00:00,  6.78s/it]
[2025-12-03 03:04:16,745][src.alfred.alfred_evaluator][INFO] - []
Error executing job with overrides: []
Traceback (most recent call last):
  File "/notebooks/LLMTaskPlanning/src/evaluate.py", line 31, in main
    evaluator.evaluate()
  File "/notebooks/LLMTaskPlanning/src/alfred/alfred_evaluator.py", line 104, in evaluate
    log.info(f'success rate: {n_success / n * 100:.2f} % ({n_success}/{n})')
                              ~~~~~~~~~~^~~
ZeroDivisionError: division by zero

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
